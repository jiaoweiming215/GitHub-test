
---
# Protothreads简介
---

Protothreads简介是一种针对C语言封装后的宏函数库，为C语言模拟了一种无堆栈的轻量线程环境，能够实现模拟线程的条件阻塞、信号量操作等操作系统中特有的机制，从而使程序实现多线程操作。
每个Protothreads线程仅增加10行代码和2字节RAM的额外硬件资源消耗。对于资源紧缺而不能移植嵌入式操作系统的嵌入式系统，使用Protothreads能够方便直观设计多任务程序，能够实现用线性程序结构处理事件驱动型程序和状态机程序，简化了该程序的设计。

---
特性：
1.没有专门的机器代码，纯C实现；
2.不用容易犯错的跳转指令；
3.极小的内存占用；
4.当不当操作系统都行；
5.所提供的阻断等待不需要堆栈或full multi-threading

---
代码实现保存任务状态的功能，实际上LC_RESUME,LC_SET,LC_END组成一个switch结构，把整个任务包在其中，每次退出时LC_SET将当前的行号保存在全局变量s中，
当下次运行时switch语句根据s的值直接跳到LC_SET的下一条语句。所以我们每个任务只需要额外的一个整型变量保存行号就可以了。
